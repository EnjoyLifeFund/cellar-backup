'use strict';

var exec = require('execa');
var plist = require('plist');

var defaultOptions = ['-r', '-n'];

var ioreg = function ioreg() {
  var className = arguments.length <= 0 || arguments[0] === undefined ? 'Root' : arguments[0];
  var options = arguments.length <= 1 || arguments[1] === undefined ? defaultOptions : arguments[1];

  return new Promise(function (resolve, reject) {
    exec('ioreg', ['-a'].concat(options).concat(className)).then(function (stdio) {
      return Promise.resolve(stdio.stdout);
    }).then(function (stdout) {
      return resolve(plist.parse(stdout));
    }).catch(function (err) {
      return reject(err);
    });
  });
};

module.exports = ioreg;