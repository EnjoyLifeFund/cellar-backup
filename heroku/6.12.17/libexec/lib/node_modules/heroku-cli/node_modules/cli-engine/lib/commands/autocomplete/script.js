'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _path = require('path');

var _path2 = _interopRequireDefault(_path);

var _ = require('.');

var _2 = _interopRequireDefault(_);

var _autocomplete = require('../../autocomplete');

var _autocomplete2 = _interopRequireDefault(_autocomplete);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

class AutocompleteScript extends _2.default {
  // hide until beta release
  async run() {
    this.errorIfWindows();
    await new _autocomplete2.default(this).generateCommandsCache();

    const shell = this.argv[0] || this.config.shell;
    if (!shell) {
      this.out.error('Error: Missing required argument shell');
    }

    switch (shell) {
      case 'zsh':
        this.out.log(`fpath=(
  ${_path2.default.join(this.functionsPath, 'zsh')}
  $fpath
);
autoload -Uz compinit;
compinit;`);
        break;
      default:
        this.out.error(`No autocomplete script for ${shell}. Run $ heroku autocomplete for install instructions.`);
    }
  }
}
exports.default = AutocompleteScript;
AutocompleteScript.topic = 'autocomplete';
AutocompleteScript.command = 'script';
AutocompleteScript.description = 'outputs autocomplete config script for shells';
AutocompleteScript.hidden = true;
AutocompleteScript.args = [{ name: 'shell', description: 'shell type', required: false }];